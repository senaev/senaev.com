# ClusterSecretStore: cluster-wide gateway for External Secrets Operator to read from Vault.
# Requires Vault to be unsealed and Kubernetes auth configured (see k8s/vault-bootstrap.sh).
# ESO uses the referenced ServiceAccount's token to authenticate to Vault via Kubernetes auth.
---
apiVersion: external-secrets.io/v1beta1
kind: ClusterSecretStore
metadata:
  name: vault
spec:
  provider:
    vault:
      server: "http://vault.vault.svc.cluster.local:8200"
      path: "secret"
      version: v2
      auth:
        kubernetes:
          mountPath: "kubernetes"
          role: "external-secrets"
          serviceAccountRef:
            name: "external-secrets"
            namespace: "vault"
  retrySettings:
    maxRetries: 10
    retryInterval: "30s"
